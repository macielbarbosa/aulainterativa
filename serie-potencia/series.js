var parameters = {
    "id":"ggb",
    "width":500,
    "height":400,
    "showToolBar":false,
    "borderColor":null,
    "showMenuBar":false,
    "showAlgebraInput":false,
    "showResetIcon":false,
    "enableLabelDrags":false,
    "enableShiftDragZoom":false,
    "enableRightClick":false,
    "capturingThreshold":null,
    "showToolBarHelp":false,
    "errorDialogsActive":false,
    "useBrowserForJS":true,
    "ggbBase64":"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"
};
var applet = new GGBApplet(parameters, '5.0');
applet.setHTML5Codebase('https://app.geogebra.org/5.0/web3d/');

var ggb = document.ggb;
var n=0;
var ggbInit=false;
var primeiros=false;
var manter=false;
var nManter=0;
var manterAnterior=0;

window.onload = function() {
    applet.inject('applet_container','preferHTML5');
    initialValues();
}

function ggbOnInit () {
    ggb.enableRightClick(false);
    ggb.enableShiftDragZoom(false);
    ggbInit=true;
}

function initialValues () {
    return;
}

function geogebra (comando) {
    document.ggb.evalCommand(comando);
}

function somatorio (command) {
    if (!ggbInit) return;
    var somatorio = '';
    var serie = '(-1/4)^n(x-2)^n';
    var atual = document.getElementById('atual');
    var btnPrev = document.getElementById('btn-prev');
    var btnNext = document.getElementById('btn-next');
    var checkboxManter = document.getElementById('manter')
    switch (command) {
        case 'next':
        n++;
        break;
        case 'previous':
        n--;
        break;
        case 'reset':
        n=0;
        if (primeiros)
            primeirosTermos();
        if (checkboxManter.checked) {
            checkboxManter.checked = false;
            manterSomas(false);
        }
    }
    for (var i=0; i<=n; i++) {
        somatorio += serie.replace(/n/gi,i);
        if (i!=n) somatorio+='+';
    }
    if (!manter) {
        ggb.setVisible('somatorio',true);
        ggb.setVisible('s'+manterAnterior,false);
        geogebra('somatorio(x)='+somatorio);
    }
    else {
        geogebra('s'+(nManter++)+'='+somatorio);
    }
    atual.innerHTML = '`y_'+(n+1)+'`';
    btnPrev.innerHTML = '`y_'+(n)+'`';
    btnNext.innerHTML = '`y_'+(n+2)+'`';
    btnPrev.disabled = n==0;
    console.log(n);
    console.log(somatorio);
    MathJax.Hub.Typeset();
}

function primeirosTermos () {
    if (!ggbInit) return;
    primeiros = !primeiros;
    for (var i=1; i<=4; i++) ggb.setVisible('y'+i,primeiros);
}

function manterSomas (checked) {
    manter = checked;
    if (!checked) {
        ggb.setVisible('somatorio',false);
        for (var i=manterAnterior; i<nManter-1; i++) ggb.setVisible('s'+i,false);
        manterAnterior = nManter-1;
    }
}