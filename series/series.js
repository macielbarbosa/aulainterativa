var parameters = {
    "id":"ggb",
    "width":600,
    "height":500,
    "showToolBar":false,
    "borderColor":null,
    "showMenuBar":false,
    "showAlgebraInput":false,
    "showResetIcon":false,
    "enableLabelDrags":false,
    "enableShiftDragZoom":true,
    "enableRightClick":false,
    "capturingThreshold":null,
    "showToolBarHelp":false,
    "errorDialogsActive":false,
    "useBrowserForJS":true,
    "ggbBase64":"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"
};
var applet = new GGBApplet(parameters, '5.0');
applet.setHTML5Codebase('https://app.geogebra.org/5.0/web3d/');

var ggb = document.ggb;
var n=-1;
var ggbInit=false;

window.onload = function() {
    applet.inject('applet_container','preferHTML5');
    initialValues();
}

function ggbOnInit () {
    ggb.enableRightClick(false);
    ggbInit=true;
}

function initialValues () {
    return;
}

function geogebra (comando) {
    document.ggb.evalCommand(comando);
}

function somatorio (command) {
    if (!ggbInit) return;
    var somatorio = '';
    var input = document.getElementById('input').value;
    var numero = document.getElementById('n');
    var resultado = document.getElementById('resultado');
    switch (command) {
        case 'next':
        n++;
        break;
        case 'previous':
        if(n<=0) return;
        n--;
        break;
        case 'reset':
        n=-1;
        ggb.setVisible("somatorio",false);
    }
    for (var i=0; i<=n; i++) {
        somatorio += input.replace(/n/gi,i);
        if (i!=n) somatorio+='+';
    }
    
    if(n!=-1){
        ggb.setVisible('somatorio',true);
        geogebra('somatorio(x)='+somatorio);
    }
    resultado.style.display = n!=-1 ? 'block' : 'none';
    numero.innerHTML = n;
    //document.getElementById('somatorio').innerHTML = '`'+somatorio+'`';
    //MathJax.Hub.Typeset();

    console.log(n);
    console.log(somatorio);
}