var parameters = {
    "id":"ggb",
    "width":600,
    "height":500,
    "showToolBar":false,
    "borderColor":null,
    "showMenuBar":false,
    "showAlgebraInput":false,
    "showResetIcon":false,
    "enableLabelDrags":false,
    "enableShiftDragZoom":true,
    "enableRightClick":false,
    "capturingThreshold":null,
    "showToolBarHelp":false,
    "errorDialogsActive":false,
    "useBrowserForJS":true,
    "ggbBase64":"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"
};
var applet = new GGBApplet(parameters, '5.0');
applet.setHTML5Codebase('https://app.geogebra.org/5.0/web3d/');

var ggb = document.ggb;
var n=-1;
var ggbInit=false;

window.onload = function() {
    applet.inject('applet_container','preferHTML5');
    initialValues();
}

function ggbOnInit () {
    ggb.enableRightClick(false);
    ggbInit=true;
}

function initialValues () {
    return;
}

function geogebra (comando) {
    document.ggb.evalCommand(comando);
}

function submit() {
    var input = document.getElementById('input').value;
    document.getElementById('digitado').innerHTML = '`sum_(n=0)^infty'+input+'`';
    geogebra('somatorio(n,x)='+input);
    geogebra('a(x)=somatorio(0,x)');
    geogebra('r(x)=(somatorio(0,x)+somatorio(1,x)+somatorio(2,x))/(somatorio(0,x)+somatorio(1,x))');
    console.log('a='+ggb.getValue('a'));
    console.log('r='+ggb.getValueString('r'));
    MathJax.Hub.Typeset();
    /*var array = input.match(/\(([^)]+)\)/g);
    console.log(array);*/
}

function somatorio (command) {
    if (!ggbInit) return;
    var somatorio = '';
    var input = document.getElementById('input').value;
    var numero = document.getElementById('n');
    var resultado = document.getElementById('resultado');
    var funcao = document.getElementById('funcao').value;
    switch (command) {
        case 'next':
        n++;
        break;
        case 'previous':
        if(n<=0) return;
        n--;
        break;
        case 'reset':
        n=-1;
        ggb.setVisible("somatorio",false);
    }
    for (var i=0; i<=n; i++) {
        somatorio += input.replace(/n/gi,i);
        if (i!=n) somatorio+='+';
    }
    
    if(n!=-1){
        ggb.setVisible('somatorio',true);
        geogebra('somatorio(x)='+somatorio);
    }
    geogebra('f(x)='+funcao); 
    resultado.style.display = n!=-1 ? 'block' : 'none';
    numero.innerHTML = n;
    //document.getElementById('somatorio').innerHTML = '`'+somatorio+'`';
    //MathJax.Hub.Typeset();

    console.log(n);
    console.log(somatorio);
}