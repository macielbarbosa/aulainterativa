var parameters = {
    "id":"ggb",
    "width":500,
    "height":400,
    "showToolBar":false,
    "borderColor":null,
    "showMenuBar":false,
    "showAlgebraInput":false,
    "showResetIcon":false,
    "enableLabelDrags":false,
    "enableShiftDragZoom":false,
    "enableRightClick":false,
    "capturingThreshold":null,
    "showToolBarHelp":false,
    "errorDialogsActive":false,
    "useBrowserForJS":true,
    "ggbBase64":"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"
};
var applet = new GGBApplet(parameters, '5.0');
applet.setHTML5Codebase('https://app.geogebra.org/5.0/web3d/');

var ggb = document.ggb;
var n=0;
var ggbInit=false;
var primeiros=false;
var manter=false;
var nManter=0;
var manterAnterior=0;

window.onload = function() {
    applet.inject('applet_container','preferHTML5');
    initialValues();
}

function ggbOnInit () {
    ggb.enableRightClick(false);
    ggb.enableShiftDragZoom(false);
    ggbInit=true;
}

function initialValues () {
    return;
}

function geogebra (comando) {
    document.ggb.evalCommand(comando);
}

function somatorio (command) {
    if (!ggbInit) return;
    var somatorio = '';
    var serie = '(-1/4)^n(x-2)^n';
    var atual = document.getElementById('atual');
    var btnPrev = document.getElementById('btn-prev');
    var btnNext = document.getElementById('btn-next');
    var checkboxManter = document.getElementById('manter')
    switch (command) {
        case 'next':
        n++;
        break;
        case 'previous':
        n--;
        break;
        case 'reset':
        n=0;
        if (primeiros)
            primeirosTermos();
        if (checkboxManter.checked) {
            checkboxManter.checked = false;
            manterSomas(false);
        }
    }
    for (var i=0; i<=n; i++) {
        somatorio += serie.replace(/n/gi,i);
        if (i!=n) somatorio+='+';
    }
    if (!manter) {
        ggb.setVisible('somatorio',true);
        ggb.setVisible('s'+manterAnterior,false);
        geogebra('somatorio(x)='+somatorio);
    }
    else {
        geogebra('s'+(nManter++)+'='+somatorio);
    }
    atual.innerHTML = '`y_'+(n+1)+'`';
    btnPrev.innerHTML = '`y_'+(n)+'`';
    btnNext.innerHTML = '`y_'+(n+2)+'`';
    btnPrev.disabled = n==0;
    console.log(n);
    console.log(somatorio);
    MathJax.Hub.Typeset();
}

function primeirosTermos () {
    if (!ggbInit) return;
    primeiros = !primeiros;
    for (var i=1; i<=4; i++) ggb.setVisible('y'+i,primeiros);
}

function manterSomas (checked) {
    manter = checked;
    if (!checked) {
        ggb.setVisible('somatorio',false);
        for (var i=manterAnterior; i<nManter-1; i++) ggb.setVisible('s'+i,false);
        manterAnterior = nManter-1;
    }
}