var parameters = {"id":"mSSxwJPG","width":700,"height":575,"showToolBar":false,"borderColor":null,"showMenuBar":false,"showAlgebraInput":false,"showResetIcon":false,"enableLabelDrags":false,"enableShiftDragZoom":true,"enableRightClick":false,"capturingThreshold":null,"showToolBarHelp":false,"errorDialogsActive":false,"useBrowserForJS":false,"ggbBase64":"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"};
var applet = new GGBApplet(parameters, '5.0');
//applet.setHTML5Codebase('https://app.geogebra.org/5.0/web3d/');
window.onload = function() {
	applet.inject('applet_container','preferHTML5');

}
var reset = true;
function plotV(){
	if(reset){	//evitar bug de primeira utilização do ggbApplet
		ggbApplet.reset();
		reset = false;
	}
	ggb = document.ggbApplet;
	dados = document.getElementById('dados');
	coordenadas = dados.elements[0].value;
	var moduloV;
	if(!coordenadas || !coordenadasV()){
		alert('ENTRADA INVÁLIDA\nPor favor, adicione as coordenadas númericas ( x , y , z ) do vetor v separadas por vírculas');
		return;
	}
	ggb.evalCommand('Pz = ('+ coordenadas +')');
	vx = ggb.getXcoord('Pz');
	vy = ggb.getYcoord('Pz');
	vz = ggb.getZcoord('Pz');
	moduloV = Math.sqrt(Math.pow(vx,2)+Math.pow(vy,2)+Math.pow(vz,2));
	ggb.setCoordSystem(-moduloV,moduloV,-moduloV,moduloV,-moduloV,moduloV,false);
	document.getElementById('v').innerHTML = '<br/><b>v</b> = ('+vx+', '+vy+', '+vz+')<br/><br/>| <b>v</b> | = '+moduloV.toFixed(2)+'<br/><br/>';
	
	document.getElementById("matrizV").innerHTML = '`[['+vx+'],['+vy+'],['+vz+']]`';
	document.getElementById('v').style.display = 'block';
	document.getElementById("v'").style.display = 'none';
	document.getElementById("matrizRotZ").style.display = 'none';
	document.getElementById("matrizRotY").style.display = 'none';
	document.getElementById("matrizRotX").style.display = 'none';
	document.getElementById("demo").style.display = 'none';

	ggb.evalCommand('v = Pz');
	ggb.setVisible('v',true);
	ggb.setVisible('cX',false);
	ggb.setVisible('cY',false);
	ggb.setVisible('cZ',false);
	ggb.setValue('tx',0);
	ggb.setValue('ty',0);
	ggb.setValue('tz',0);
	ggb.setVisible("v'",false);
}
function rotacionar(){
	nz = dados.elements[3].value;
	ny = dados.elements[5].value;
	nx = dados.elements[8].value;
	rotZ = document.getElementById('rotZ').checked;
	rotY = document.getElementById('rotY').checked;
	rotX = document.getElementById('rotX').checked;
	plotV();
	if(nz && rotZ){
		rotacionarZ();
		if(ny && rotY){
			setTimeout(rotacionarY, 1500);
			if(nx && rotX)
			setTimeout(rotacionarX,3000);
		}
		else if(nx && rotX)
			setTimeout(rotacionarX, 1500);
	}
	else if(ny && rotY) {
		rotacionarY();
		if(nx && rotX)
			setTimeout(rotacionarX, 1500);
	}
	else if(nx && rotX)
		rotacionarX();
	atualizarComponentes();
	matrizesRotacao();
	document.getElementById("v'").style.display = 'block';
	document.getElementById("demo").style.display = 'block';
	MathJax.Hub.Typeset(); //atualizar notacao asciimath
}
function rotacionarZ(){
	rotacaoNegativa('z');
	ggb.evalCommand("v' = Qz");
	ggb.evalCommand('nz = '+Math.abs(nz));
	if((!rotY || !ny) && (!rotX || !nx))
		ggb.setVisible('cZ',true);
	ggb.setVisible("v'",true);
	ggb.evalCommand('StartAnimation[tz]');
}
function rotacionarY(){
	rotacaoNegativa('y');
	if(rotZ && nz)
		ggb.evalCommand('Py = Rotate[Pz,'+nz+'°,zAxis]');
	else
		ggb.evalCommand('Py = ('+coordenadas+')');
	ggb.evalCommand("v' = Qy");
	ggb.evalCommand('ny = '+Math.abs(ny));
	if((!rotZ || !nz) && (!rotX || !nx))
		ggb.setVisible('cY',true);
	ggb.setVisible("v'",true);
	ggb.evalCommand('StartAnimation[ty]');
}
function rotacionarX(){
	rotacaoNegativa('x');
	if(ny && rotY)
		ggb.evalCommand('Px = Rotate[Py,'+ny+'°,yAxis]');
	else if(rotZ && nz)
		ggb.evalCommand('Px = Rotate[Pz,'+nz+'°,zAxis]');
	else
		ggb.evalCommand('Px = ('+coordenadas+')');
	ggb.evalCommand("v' = Qx");
	ggb.evalCommand('nx = '+Math.abs(nx));
	if((!rotZ || !nz) && (!rotY || !ny))
		ggb.setVisible('cX',true);
	ggb.setVisible("v'",true);
	ggb.evalCommand('StartAnimation[tx]');
}
function rotacaoNegativa(eixo){
	if(eixo=='z'){
		if(nz<0){	
			ggb.evalCommand('Qz=Rotate[Pz,(-tz)°,zAxis]');
			ggb.evalCommand('α=Angle[Qz,Cz,Pz,zAxis]');
			ggb.evalCommand('Mz=Rotate[Pz,-0.001°,zAxis]');
		}
		else{
			ggb.evalCommand('Qz=Rotate[Pz,tz°,zAxis]');
			ggb.evalCommand('α=Angle[Pz,Cz,Qz,zAxis]');
			ggb.evalCommand('Mz=Rotate[Pz,0.001°,zAxis]');
		}
	}
	else if(eixo=='y')
		if(ny<0){	
			ggb.evalCommand('Qy=Rotate[Py,(-ty)°,yAxis]');
			ggb.evalCommand('β=Angle[Qy,Cy,Py,yAxis]');
			ggb.evalCommand('My=Rotate[Py,-0.001°,yAxis]');
		}
		else{
			ggb.evalCommand('Qy=Rotate[Py,ty°,yAxis]');
			ggb.evalCommand('β=Angle[Py,Cy,Qy,yAxis]');
			ggb.evalCommand('My=Rotate[Py,0.001°,yAxis]');
		}
	else{
		if(nx<0){	
			ggb.evalCommand('Qx=Rotate[Px,(-tx)°,xAxis]');
			ggb.evalCommand('γ=Angle[Qx,Cx,Px,xAxis]');
			ggb.evalCommand('Mx=Rotate[Px,-0.001°,xAxis]');
		}
		else{
			ggb.evalCommand('Qx=Rotate[Px,tx°,xAxis]');
			ggb.evalCommand('γ=Angle[Px,Cx,Qx,xAxis]');
			ggb.evalCommand('Mx=Rotate[Px,0.001°,xAxis]');
		}
	}
}
function atualizarComponentes(){
	rotacaoV();
	var x = vx;
	var y = vy;
	var z = vz;			
	var modulo = Math.sqrt(Math.pow(x,2)+Math.pow(y,2)+Math.pow(z,2));
	if(Math.abs(Math.round(x)-x)<0.005)
		x = Math.round(x);
	else
		x = x.toFixed(2);
	if(Math.abs(Math.round(y)-y)<0.005)
		y = Math.round(y);
	else
		y = y.toFixed(2);
	if(Math.abs(Math.round(z)-z)<0.005)
		z = Math.round(z);
	else
		z = z.toFixed(2);
	document.getElementById("v'").innerHTML = "<br/><b>v</b>' = ("+x+", "+y+", "+z+")<br/><br/>| <b>v</b>' | = "+modulo.toFixed(2)+"<br/><br/>";
	document.getElementById("matrizV'").innerHTML = '`[['+x+'],['+y+'],['+z+']]`';
}
function rotacaoV(){
	if(nz && rotZ){
		rotacaoVz();
		if(ny && rotY)
			rotacaoVy();
		if(nx && rotX)
			rotacaoVx();
	}
	else if(ny && rotY){
		rotacaoVy();
		if(nx && rotX)
			rotacaoVx();
	}
	else if(nx && rotX)
		rotacaoVx();
}
function rotacaoVz(){
	var x = vx, y = vy, z = vz; //não usar o valor alterado
	vx = x*Math.cos(nz*Math.PI/180) - y*Math.sin(nz*Math.PI/180);
	vy = x*Math.sin(nz*Math.PI/180) + y*Math.cos(nz*Math.PI/180);
}
function rotacaoVy(){
	var x = vx, y = vy, z = vz; //não usar o valor alterado
	vx = x*Math.cos(ny*Math.PI/180) + z*Math.sin(ny*Math.PI/180);
	vz = -x*Math.sin(ny*Math.PI/180) + z*Math.cos(ny*Math.PI/180);
}
function rotacaoVx(){
	var x = vx, y = vy, z = vz; //não usar o valor alterado
	vy = y*Math.cos(nx*Math.PI/180) - z*Math.sin(nx*Math.PI/180);
	vz = y*Math.sin(nx*Math.PI/180) + z*Math.cos(nx*Math.PI/180);
}
function matrizesRotacao(){
	var matrizRotZ = document.getElementById('matrizRotZ');
	var matrizRotY = document.getElementById('matrizRotY');
	var matrizRotX = document.getElementById('matrizRotX');
	if(rotZ && nz){
		matrizRotZ.innerHTML = '`[[cos'+nz+'\"&deg;\",-sin'+nz+'\"&deg;\",0],[sin'+nz+'\"&deg;\",cos'+nz+'\"&deg;\", 0],[0,0,1]]xx`';					
		matrizRotZ.style.display = 'inline';
	}
	if(rotY && ny){
		matrizRotY.innerHTML = '`[[cos'+ny+'\"&deg;\",0,sin'+ny+'\"&deg;\"],[0,1,0],[-sin'+ny+'\"&deg;\",0,cos'+ny+'\"&deg;\"]]xx`';
		matrizRotY.style.display = 'inline';
	}
	if(rotX && nx){
		matrizRotX.innerHTML = '`[[1,0,0],[0,cos'+nx+'\"&deg;\",-sin'+nx+'\"&deg;\"],[0,sin'+nx+'\"&deg;\",cos'+nx+'\"&deg;\"]]xx`';
		matrizRotX.style.display = 'inline';
	}
	var eqRot = document.getElementById('eqRot');
	if(nz && rotZ){
		eqRot.innerHTML = '`v\' = R_alpha"&nbsp;"v`';
		if(ny && rotY)
			eqRot.innerHTML = '`v\' = R_betaR_alpha"&nbsp;"v`';
		else if(nx && rotX)
			eqRot.innerHTML = '`v\' = R_gammaR_alpha"&nbsp;"v`';
		if(ny && rotY && nx && rotX)
			eqRot.innerHTML = '`v\' = R_gammaR_betaR_alpha"&nbsp;"v`';
	}
	else if(ny && rotY) {
		eqRot.innerHTML = '`v\' = R_beta"&nbsp;"v`';
		if(nx && rotX)
			eqRot.innerHTML = '`v\' = R_gammaR_beta"&nbsp;"v`';
	}
	else if(nx && rotX)
		eqRot.innerHTML = '`v\' = R_gamma"&nbsp;"v`';
}
function coordenadasV(){
	var virgulas = 0;
	var letras = 0;
	for(var i=0; i<coordenadas.length; i++){
		if(i!=coordenadas.length-1 && coordenadas.charAt(i)=='.' && coordenadas.charAt(i+1)=='.')
			return false;
		else if(coordenadas.charAt(i)==' ' || coordenadas.charAt(i)=='.')
			continue;
		else if(coordenadas.charAt(i)==',')
			virgulas++;
		else if(coordenadas.charAt(i)<'0' || coordenadas.charAt(i)>'9')
			letras++;
	}
	return virgulas==2 && letras==0;
}